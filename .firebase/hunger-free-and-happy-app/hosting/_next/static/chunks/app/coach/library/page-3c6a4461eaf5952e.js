(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[787],{5225:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});let l=(0,a(14294).A)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},24128:(e,t,a)=>{"use strict";a.d(t,{h:()=>r});var l=a(30926);let r=(0,l.createServerReference)("60b6220a6d18ecff3dec0d0dcce342766e70717942",l.callServer,void 0,l.findSourceMapURL,"deleteDocumentAction")},32467:(e,t,a)=>{"use strict";a.d(t,{DX:()=>u,TL:()=>o});var l,r=a(12115),s=a(94446),n=a(95155),d=Symbol.for("react.lazy"),i=(l||(l=a.t(r,2)))[" use ".trim().toString()];function c(e){var t;return null!=e&&"object"==typeof e&&"$$typeof"in e&&e.$$typeof===d&&"_payload"in e&&"object"==typeof(t=e._payload)&&null!==t&&"then"in t}function o(e){let t=function(e){let t=r.forwardRef((e,t)=>{let{children:a,...l}=e;if(c(a)&&"function"==typeof i&&(a=i(a._payload)),r.isValidElement(a)){var n;let e,d,i=(n=a,(d=(e=Object.getOwnPropertyDescriptor(n.props,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.ref:(d=(e=Object.getOwnPropertyDescriptor(n,"ref")?.get)&&"isReactWarning"in e&&e.isReactWarning)?n.props.ref:n.props.ref||n.ref),c=function(e,t){let a={...t};for(let l in t){let r=e[l],s=t[l];/^on[A-Z]/.test(l)?r&&s?a[l]=(...e)=>{let t=s(...e);return r(...e),t}:r&&(a[l]=r):"style"===l?a[l]={...r,...s}:"className"===l&&(a[l]=[r,s].filter(Boolean).join(" "))}return{...e,...a}}(l,a.props);return a.type!==r.Fragment&&(c.ref=t?(0,s.t)(t,i):i),r.cloneElement(a,c)}return r.Children.count(a)>1?r.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}(e),a=r.forwardRef((e,a)=>{let{children:l,...s}=e;c(l)&&"function"==typeof i&&(l=i(l._payload));let d=r.Children.toArray(l),o=d.find(m);if(o){let e=o.props.children,l=d.map(t=>t!==o?t:r.Children.count(e)>1?r.Children.only(null):r.isValidElement(e)?e.props.children:null);return(0,n.jsx)(t,{...s,ref:a,children:r.isValidElement(e)?r.cloneElement(e,void 0,l):null})}return(0,n.jsx)(t,{...s,ref:a,children:l})});return a.displayName=`${e}.Slot`,a}var u=o("Slot"),f=Symbol("radix.slottable");function m(e){return r.isValidElement(e)&&"function"==typeof e.type&&"__radixId"in e.type&&e.type.__radixId===f}},49330:(e,t,a)=>{Promise.resolve().then(a.bind(a,96004))},55073:(e,t,a)=>{"use strict";a.d(t,{s:()=>r});var l=a(30926);let r=(0,l.createServerReference)("003cfa04c1e0760f50917c16014e9a25cf42ac9c8e",l.callServer,void 0,l.findSourceMapURL,"getLibraryDocumentsAction")},61774:(e,t,a)=>{"use strict";a.d(t,{P:()=>r});var l=a(30926);let r=(0,l.createServerReference)("7e1ccefe58394283c8680c6c0d39c9b4267b6eccfb",l.callServer,void 0,l.findSourceMapURL,"uploadDocumentAction")},83101:(e,t,a)=>{"use strict";a.d(t,{F:()=>n});var l=a(2821);let r=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,s=l.$,n=(e,t)=>a=>{var l;if((null==t?void 0:t.variants)==null)return s(e,null==a?void 0:a.class,null==a?void 0:a.className);let{variants:n,defaultVariants:d}=t,i=Object.keys(n).map(e=>{let t=null==a?void 0:a[e],l=null==d?void 0:d[e];if(null===t)return null;let s=r(t)||r(l);return n[e][s]}),c=a&&Object.entries(a).reduce((e,t)=>{let[a,l]=t;return void 0===l||(e[a]=l),e},{});return s(e,i,null==t||null==(l=t.compoundVariants)?void 0:l.reduce((e,t)=>{let{class:a,className:l,...r}=t;return Object.entries(r).every(e=>{let[t,a]=e;return Array.isArray(a)?a.includes({...d,...c}[t]):({...d,...c})[t]===a})?[...e,a,l]:e},[]),null==a?void 0:a.class,null==a?void 0:a.className)}},96004:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var l=a(95155),r=a(12115),s=a(86948),n=a(3998),d=a(64269);let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("div",{className:"relative w-full overflow-auto",children:(0,l.jsx)("table",{ref:t,className:(0,d.cn)("w-full caption-bottom text-sm",a),...r})})});i.displayName="Table";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("thead",{ref:t,className:(0,d.cn)("[&_tr]:border-b",a),...r})});c.displayName="TableHeader";let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("tbody",{ref:t,className:(0,d.cn)("[&_tr:last-child]:border-0",a),...r})});o.displayName="TableBody",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("tfoot",{ref:t,className:(0,d.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("tr",{ref:t,className:(0,d.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});u.displayName="TableRow";let f=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("th",{ref:t,className:(0,d.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",a),...r})});f.displayName="TableHead";let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("td",{ref:t,className:(0,d.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...r})});m.displayName="TableCell",r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)("caption",{ref:t,className:(0,d.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption";var p=a(92033),x=a(22452),h=a(5225),y=a(13630),j=a(15894),v=a(55073),N=a(61774),b=a(24128),g=a(5282),w=a(98053),R=a(17037),A=a(82224);function k(){var e;let{toast:t}=(0,j.dj)(),{user:a}=(0,A.A)(),[d,k]=(0,r.useState)([]),[C,S]=(0,r.useState)(!0),[D,E]=(0,r.useState)(!1),[_,T]=(0,r.useState)(null),[O,U]=(0,r.useState)({open:!1,doc:null}),$=(0,r.useRef)(null),L=(0,r.useCallback)(async()=>{S(!0);let e=await (0,v.s)();e.success&&e.data?k(e.data):t({variant:"destructive",title:"Error",description:"Could not fetch library documents."}),S(!1)},[t]);(0,r.useEffect)(()=>{L()},[L]);let P=async e=>{var l;let r=null==(l=e.target.files)?void 0:l[0];if(r&&a){E(!0);try{let e=new FileReader;e.readAsDataURL(r),e.onload=async()=>{let l=e.result,s=await (0,N.P)(l,r.name,r.type,"",a.uid,a.displayName||"Coach");if(s.success)t({title:"Upload Successful",description:'"'.concat(r.name,'" has been added to the library.')}),L();else throw Error(s.error||"Upload failed")}}catch(e){t({variant:"destructive",title:"Upload Error",description:e.message})}finally{E(!1),$.current&&($.current.value="")}}},F=async()=>{if(O.doc){T(O.doc.id);try{let e=await (0,b.h)(O.doc.id,O.doc.storagePath);if(e.success)t({title:"Document Deleted",description:'"'.concat(O.doc.name,'" has been removed.')}),L();else throw Error(e.error||"Failed to delete document.")}catch(e){t({variant:"destructive",title:"Deletion Error",description:e.message})}finally{T(null),U({open:!1,doc:null})}}};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"space-y-8 h-full flex flex-col",children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Document Library"}),(0,l.jsx)("p",{className:"text-muted-foreground",children:"Upload and manage documents to power the AI's knowledge base."})]}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"file",ref:$,onChange:P,className:"hidden"}),(0,l.jsxs)(n.$,{onClick:()=>{var e;return null==(e=$.current)?void 0:e.click()},disabled:D,children:[D?(0,l.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,l.jsx)(x.A,{className:"mr-2 h-4 w-4"}),"Upload Document"]})]})]}),(0,l.jsx)("div",{className:"flex-1 min-h-0",children:(0,l.jsxs)(s.Zp,{className:"flex flex-col h-full",children:[(0,l.jsxs)(s.aR,{children:[(0,l.jsx)(s.ZB,{children:"Uploaded Documents"}),(0,l.jsx)(s.BT,{children:"This is the central knowledge base for the AI."})]}),C?(0,l.jsx)(s.Wu,{className:"flex-1 flex items-center justify-center",children:(0,l.jsx)(p.A,{className:"h-12 w-12 animate-spin text-primary"})}):0===d.length?(0,l.jsx)(s.Wu,{className:"flex-1 flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-center text-muted-foreground",children:"No documents have been uploaded yet."})}):(0,l.jsx)("div",{className:"flex-1 min-h-0",children:(0,l.jsx)(R.F,{className:"h-full",children:(0,l.jsxs)(i,{children:[(0,l.jsx)(c,{children:(0,l.jsxs)(u,{children:[(0,l.jsx)(f,{children:"Name"}),(0,l.jsx)(f,{children:"Type"}),(0,l.jsx)(f,{children:"Date Added"}),(0,l.jsx)(f,{className:"text-right",children:"Actions"})]})}),(0,l.jsx)(o,{children:d.map(e=>(0,l.jsxs)(u,{children:[(0,l.jsxs)(m,{className:"font-medium flex items-center gap-2",children:[(0,l.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"}),e.name]}),(0,l.jsx)(m,{children:e.type}),(0,l.jsx)(m,{children:(0,g.GP)(new Date(e.createdAt),"PPP")}),(0,l.jsx)(m,{className:"text-right",children:(0,l.jsx)(n.$,{variant:"ghost",size:"icon",onClick:()=>U({open:!0,doc:e}),disabled:_===e.id,children:_===e.id?(0,l.jsx)(p.A,{className:"h-4 w-4 animate-spin"}):(0,l.jsx)(y.A,{className:"h-4 w-4 text-destructive"})})})]},e.id))})]})})})]})})]}),(0,l.jsx)(w.Lt,{open:O.open,onOpenChange:e=>!e&&U({open:!1,doc:null}),children:(0,l.jsxs)(w.EO,{children:[(0,l.jsxs)(w.wd,{children:[(0,l.jsx)(w.r7,{children:"Are you absolutely sure?"}),(0,l.jsxs)(w.$v,{children:['This action cannot be undone. This will permanently delete the document "',null==(e=O.doc)?void 0:e.name,"\" from the AI's knowledge base."]})]}),(0,l.jsxs)(w.ck,{children:[(0,l.jsx)(w.Zr,{children:"Cancel"}),(0,l.jsx)(w.Rx,{onClick:F,className:"bg-destructive hover:bg-destructive/90",disabled:!!_,children:"Delete"})]})]})})]})}},98053:(e,t,a)=>{"use strict";a.d(t,{$v:()=>x,EO:()=>u,Lt:()=>i,Rx:()=>h,Zr:()=>y,ck:()=>m,r7:()=>p,wd:()=>f});var l=a(95155),r=a(12115),s=a(52498),n=a(64269),d=a(3998);let i=s.bL;s.l9;let c=s.ZL,o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(s.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});o.displayName=s.hJ.displayName;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsxs)(c,{children:[(0,l.jsx)(o,{}),(0,l.jsx)(s.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-[90vw] max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});u.displayName=s.UC.displayName;let f=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};f.displayName="AlertDialogHeader";let m=e=>{let{className:t,...a}=e;return(0,l.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};m.displayName="AlertDialogFooter";let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(s.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold",a),...r})});p.displayName=s.hE.displayName;let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(s.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});x.displayName=s.VY.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(s.rc,{ref:t,className:(0,n.cn)((0,d.r)(),a),...r})});h.displayName=s.rc.displayName;let y=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,l.jsx)(s.ZD,{ref:t,className:(0,n.cn)((0,d.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})});y.displayName=s.ZD.displayName}},e=>{e.O(0,[2992,7138,781,5612,5352,4972,7075,7071,8441,1255,7358],()=>e(e.s=49330)),_N_E=e.O()}]);