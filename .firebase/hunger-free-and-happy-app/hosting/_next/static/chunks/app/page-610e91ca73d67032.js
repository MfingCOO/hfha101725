(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8974],{14294:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});var n=t(12115);let a=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,n.forwardRef)((e,r)=>{let{color:t="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:c,className:l="",children:u,iconNode:d,...f}=e;return(0,n.createElement)("svg",{ref:r,...s,width:i,height:i,stroke:t,strokeWidth:c?24*Number(o)/Number(i):o,className:a("lucide",l),...f},[...d.map(e=>{let[r,t]=e;return(0,n.createElement)(r,t)}),...Array.isArray(u)?u:[u]])}),o=(e,r)=>{let t=(0,n.forwardRef)((t,s)=>{let{className:o,...c}=t;return(0,n.createElement)(i,{ref:s,iconNode:r,className:a("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),o),...c})});return t.displayName="".concat(e),t}},14585:(e,r,t)=>{"use strict";t.d(r,{BV:()=>d,db:()=>l,j2:()=>u,yA:()=>c});var n=t(52078),a=t(19708),s=t(59253),i=t(58134),o=t(83790);let c=(0,n.Dk)().length?(0,n.Sx)():(0,n.Wp)({projectId:"hunger-free-and-happy-app",appId:"1:1002580546718:web:a8574bfc3732c7c137978f",storageBucket:"hunger-free-and-happy-app.appspot.com",apiKey:"AIzaSyAk8vuQj8JfEyweNdtK9en9uUk6amEblYo",authDomain:"hunger-free-and-happy-app.firebaseapp.com",measurementId:"",messagingSenderId:"1002580546718"}),l=(0,a.aU)(c),u=(0,s.xI)(c);(0,i.c7)(c);let d=(0,o.dG)(c)},20063:(e,r,t)=>{"use strict";var n=t(47260);t.o(n,"usePathname")&&t.d(r,{usePathname:function(){return n.usePathname}}),t.o(n,"useRouter")&&t.d(r,{useRouter:function(){return n.useRouter}})},30926:(e,r,t)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),!function(e,r){for(var t in r)Object.defineProperty(e,t,{enumerable:!0,get:r[t]})}(r,{callServer:function(){return n.callServer},createServerReference:function(){return s.createServerReference},findSourceMapURL:function(){return a.findSourceMapURL}});let n=t(41209),a=t(85153),s=t(77197)},40417:(e,r,t)=>{Promise.resolve().then(t.bind(t,89547))},54618:(e,r,t)=>{"use strict";t.d(r,{h:()=>n});let n=["yue7fVPBQZg45vmfXXUH5PdG7jE2","oYsf7Iah6hVlEgHvWJ7Ms7j1oTB2","5ussqmLF0ySndTrgZHdhCQTg5J12"]},82224:(e,r,t)=>{"use strict";t.d(r,{O:()=>b,A:()=>g});var n=t(95155),a=t(12115),s=t(59253),i=t(19708),o=t(14585),c=t(92033),l=t(20063),u=t(54618),d=t(83790),f=t(30926);let h=(0,f.createServerReference)("40fe5b6557f4348cc8fb9053ccd0e0c07f293fc4ab",f.callServer,void 0,f.findSourceMapURL,"createCoachingChatOnFirstLogin"),p=(0,a.createContext)({user:null,userProfile:null,loading:!0,isCoach:!1}),g=()=>(0,a.useContext)(p),m=["/login","/signup","/tos","/privacy","/support"];function v(e){let{children:r}=e,{user:t,isCoach:s,loading:i,userProfile:o}=g(),c=(0,l.useRouter)(),u=(0,l.usePathname)();return(0,a.useEffect)(()=>{if(i)return;let e=m.some(e=>u.startsWith(e)),r=u.startsWith("/client"),n=u.startsWith("/coach");t&&o?e?c.replace(s?"/coach/dashboard":"/client/dashboard"):s&&!n?u.startsWith("/chats")||u.startsWith("/settings")||c.replace("/coach/dashboard"):s||r||u.startsWith("/chats")||u.startsWith("/settings")||c.replace("/client/dashboard"):t||e||c.replace("/login")},[t,o,s,i,u,c]),(0,n.jsx)(n.Fragment,{children:r})}function b(e){let{children:r}=e,[t,l]=(0,a.useState)(null),[f,g]=(0,a.useState)(null),[m,b]=(0,a.useState)(!0),[y,S]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{f&&h(f).catch(console.error)},[f]),(0,a.useEffect)(()=>{let e,r,t=async e=>{if("serviceWorker"in navigator&&o.BV)try{let r=await Notification.requestPermission();if("granted"===r){let r="BGNeYzhRRkl_ou3bZbjkSKTJ3SkrmfuOyRWS2wrJl92Huaz70DJZEplDQ4rhVdWl73UxaREQCw7b7Jj_sWs7PUU";if(!r)return void console.error("VAPID key not found in environment variables.");try{let t=await (0,d.gf)(o.BV,{vapidKey:r});if(t){let r=(0,i.H9)(o.db,"userProfiles",e.uid);await (0,i.mZ)(r,{fcmTokens:(0,i.hq)(t)})}else console.log("No registration token available. Request permission to generate one.")}catch(e){console.error("An error occurred while retrieving token. This is expected in some environments (like local dev without HTTPS).",e)}}}catch(e){console.error("An error occurred during notification permission request.",e)}},n=(0,s.iZ)(o.j2,async n=>{if(b(!0),e&&e(),r&&r(),n){l(n),t(n);let a=u.h.includes(n.uid);S(a);let c={},d={},f=!1,h=()=>{g({...c,...d}),f||(b(!1),f=!0)},p=(0,i.H9)(o.db,"userProfiles",n.uid);if(e=(0,i.aQ)(p,e=>{e.exists()?(c=e.data(),h()):(console.error("Auth Error: User profile not found for UID: ".concat(n.uid,". Forcing logout.")),(0,s.CI)(o.j2))},e=>{console.error("Auth Error: userProfiles snapshot listener failed.",e),(0,s.CI)(o.j2)}),a)e||b(!1);else{let e=(0,i.H9)(o.db,"clients",n.uid);r=(0,i.aQ)(e,e=>{if(e.exists()){let r=e.data();r.bingeFreeSince&&"function"==typeof r.bingeFreeSince.toDate&&(r.bingeFreeSince=r.bingeFreeSince.toMillis()),r.lastInteraction&&"function"==typeof r.lastInteraction.toDate&&(r.lastInteraction=r.lastInteraction.toMillis()),d=r}h()},e=>{console.error("Auth Error: clients snapshot listener failed.",e),h()})}}else l(null),S(!1),g(null),b(!1)});return()=>{n(),e&&e(),r&&r()}},[]),(0,n.jsx)(p.Provider,{value:{user:t,userProfile:f,loading:m,isCoach:y},children:m?(0,n.jsx)("div",{className:"flex h-screen w-screen items-center justify-center bg-background",children:(0,n.jsx)(c.A,{className:"h-8 w-8 animate-spin text-primary"})}):(0,n.jsx)(v,{children:r})})}},89547:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var n=t(82224),a=t(20063),s=t(12115);function i(){let{user:e,isCoach:r,loading:t}=(0,n.A)(),i=(0,a.useRouter)();return(0,s.useEffect)(()=>{t||(e?i.replace(r?"/coach/dashboard":"/client/dashboard"):i.replace("/login"))},[e,r,t,i]),null}}},e=>{e.O(0,[2992,7138,5612,8441,1255,7358],()=>e(e.s=40417)),_N_E=e.O()}]);