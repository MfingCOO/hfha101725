(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5219],{6150:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eW});var r=s(95155),a=s(12115),i=s(86948),n=s(3998),l=s(74206),o=s(11140),c=s(12784),d=s(37577),h=s(69693),u=s(5351),m=s(97114),g=s(89031),x=s(84336),f=s(88397),p=s(61270),y=s(36419),w=s(33173),v=s(13381),b=s(15239),j=s(61680),N=s(64269),k=s(82224),S=s(88566),C=s(30926);let A=(0,C.createServerReference)("406faf718c7df5261e54c55c63b13f8fea2053ed8d",C.callServer,void 0,C.findSourceMapURL,"getUpcomingIndulgences"),M=(0,C.createServerReference)("40905d1bdc686ef83dfcf8127b421558706a41501f",C.callServer,void 0,C.findSourceMapURL,"resetBingeStreakAction"),D=(0,C.createServerReference)("001b308f0c62f9c894be42591e7cc3234400fe2465",C.callServer,void 0,C.findSourceMapURL,"getLatestChallengeForClient"),T=(0,C.createServerReference)("6097decc63b57a6994f426f1d059d97634257a8d19",C.callServer,void 0,C.findSourceMapURL,"joinChallengeAction");var R=s(20243),q=s(11647),W=s(12360),P=s(15039),F=s(91480),I=s(92033),E=s(59338),L=s(18527),H=s(94374),z=s(96711),G=s(15894),O=s(11186),U=s(41546),B=s(51834);let $=(0,C.createServerReference)("006cf2a94807c156065be52573a3d388c5d3c92c63",C.callServer,void 0,C.findSourceMapURL,"getAssetLibrary");var K=s(26991),J=s(84879),V=s(68425),_=s(73697),Z=s(47734),Q=s(23508),Y=s(77568);let X=(0,C.createServerReference)("40018275317389bb329a1b3a460a9403cdac25bb8c",C.callServer,void 0,C.findSourceMapURL,"getWeightData");var ee=s(5282),et=s(73181),es=s(37785),er=s(26615),ea=s(82863),ei=s(78503),en=s(17037);function el(e){let{isOpen:t,onClose:s}=e,{user:i,userProfile:l}=(0,k.A)(),[o,c]=(0,a.useState)([]),[d,h]=(0,a.useState)(!0),[u,m]=(0,a.useState)(!1),[g,x]=(0,a.useState)("all");(0,a.useEffect)(()=>{m(!0)},[]),(0,a.useEffect)(()=>{t&&i&&(h(!0),X(i.uid).then(e=>{e.success&&e.data&&c(e.data.map(e=>({...e,date:(0,ee.GP)(e.entryDate,"MMM d")}))),h(!1)}))},[t,i]);let f=(0,a.useMemo)(()=>{if(!o)return[];let e=new Date;switch(g){case"1m":return o.filter(t=>new Date(t.entryDate)>=(0,et.a)(e,1));case"3m":return o.filter(t=>new Date(t.entryDate)>=(0,et.a)(e,3));case"1y":return o.filter(t=>new Date(t.entryDate)>=(0,et.a)(e,12));default:return o}},[o,g]),{stats:p,domain:y}=(0,a.useMemo)(()=>{var e;if(f.length<2)return{stats:null,domain:[100,200]};let t=f[0],s=f[f.length-1],r=t.weight,a=s.weight,i=a-r,n=(0,es.B)(s.entryDate,t.entryDate),o=(null==l||null==(e=l.onboarding)?void 0:e.units)==="metric"?"kg":"lbs",c=f.map(e=>e.weight),d=Math.min(...c),h=Math.max(...c);return{stats:{start:"".concat(r.toFixed(1)," ").concat(o),startDate:(0,ee.GP)(new Date(t.entryDate),"MMM d, yyyy"),current:"".concat(a.toFixed(1)," ").concat(o),currentDate:(0,ee.GP)(new Date(s.entryDate),"MMM d, yyyy"),change:"".concat(i>0?"+":"").concat(i.toFixed(1)," ").concat(o),duration:"in ".concat(n),changeType:i>0?"increase":i<0?"decrease":"neutral"},domain:[Math.floor(d-10),Math.ceil(h+10)]}},[f,l]);return(0,r.jsx)(B.lG,{open:t,onOpenChange:s,children:(0,r.jsxs)(B.Cf,{className:"w-[90vw] max-w-2xl",children:[(0,r.jsxs)(B.c7,{children:[(0,r.jsx)(B.L3,{children:"Weight Trend Analysis"}),(0,r.jsxs)(B.HM,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(er.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[p&&(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Start"}),(0,r.jsx)("p",{className:"font-bold text-lg",children:p.start}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:p.startDate})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current"}),(0,r.jsx)("p",{className:"font-bold text-lg",children:p.current}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:p.currentDate})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Change"}),(0,r.jsxs)("p",{className:(0,N.cn)("font-bold text-lg flex items-center justify-center gap-1","decrease"===p.changeType&&"text-green-400","increase"===p.changeType&&"text-red-400"),children:["decrease"===p.changeType?(0,r.jsx)(ea.A,{className:"h-4 w-4"}):"increase"===p.changeType?(0,r.jsx)(H.A,{className:"h-4 w-4"}):(0,r.jsx)(ei.A,{className:"h-4 w-4"}),p.change]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:p.duration})]})]}),!u||d?(0,r.jsx)("div",{className:"h-[250px] w-full flex items-center justify-center",children:(0,r.jsx)(R.E,{className:"h-full w-full"})}):f.length>1?(0,r.jsx)("div",{className:"h-[250px] w-full",children:(0,r.jsx)(K.u,{width:"100%",height:"100%",children:(0,r.jsxs)(J.Q,{data:f,margin:{top:5,right:10,left:0,bottom:0},children:[(0,r.jsx)(V.d,{strokeDasharray:"3 3",stroke:"hsl(var(--border) / 0.5)"}),(0,r.jsx)(_.h,{tickLine:!1,axisLine:!1,tickMargin:8,domain:y,tick:{fontSize:"0.75rem"}}),(0,r.jsx)(Z.W,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,tickFormatter:e=>e.slice(0,3),tick:{fontSize:"0.75rem"}}),(0,r.jsx)(Q.m,{content:(0,r.jsx)(e=>{let{active:t,payload:s,label:a}=e;if(t&&s&&s.length){let e=s[0].payload;return(0,r.jsx)("div",{className:"rounded-lg border bg-background p-2 shadow-sm",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-[0.70rem] uppercase text-muted-foreground",children:"Weight"}),(0,r.jsx)("span",{className:"font-bold text-muted-foreground",children:e.weight.toFixed(1)})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-[0.70rem] uppercase text-muted-foreground",children:"Date"}),(0,r.jsx)("span",{className:"font-bold",children:a})]})]})})}return null},{})}),(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"fillWeight",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"5%",stopColor:"hsl(var(--primary))",stopOpacity:.8}),(0,r.jsx)("stop",{offset:"95%",stopColor:"hsl(var(--primary))",stopOpacity:.1})]})}),(0,r.jsx)(Y.G,{dataKey:"weight",type:"natural",fill:"url(#fillWeight)",stroke:"hsl(var(--primary))",stackId:"a",strokeWidth:2})]})})}):(0,r.jsxs)("div",{className:"h-[250px] w-full flex flex-col items-center justify-center text-center text-muted-foreground",children:[(0,r.jsx)("p",{className:"font-semibold",children:"Not enough data to build a trend."}),(0,r.jsx)("p",{className:"text-sm",children:"Log at least two measurements to see your chart."})]}),(0,r.jsx)(()=>(0,r.jsx)("div",{className:"flex justify-center gap-1 rounded-lg bg-muted p-1",children:["1m","3m","1y","all"].map(e=>(0,r.jsx)(n.$,{onClick:()=>x(e),variant:g===e?"secondary":"ghost",size:"sm",className:"text-xs h-7 flex-1",children:e.toUpperCase()},e))}),{}),f.length>0&&(0,r.jsx)(en.F,{className:"h-24 w-full rounded-md border p-2",children:(0,r.jsx)("div",{className:"space-y-1",children:f.slice().reverse().map((e,t)=>{var s;return(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm p-1 rounded-md hover:bg-muted",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:(0,ee.GP)(new Date(e.entryDate),"MMM d, yyyy")}),(0,r.jsxs)("span",{className:"font-semibold",children:[e.weight.toFixed(1)," ",(null==l||null==(s=l.onboarding)?void 0:s.units)==="metric"?"kg":"lbs"]})]},t)})})})]})]})})}let eo=(0,C.createServerReference)("40d65bc54f63925d1a9f54dc674858ee4ce2fa994f",C.callServer,void 0,C.findSourceMapURL,"getWthrData");function ec(e){let{isOpen:t,onClose:s}=e,{user:i}=(0,k.A)(),[l,o]=(0,a.useState)([]),[c,d]=(0,a.useState)(!0),[h,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)("all");(0,a.useEffect)(()=>{u(!0)},[]),(0,a.useEffect)(()=>{t&&i&&(d(!0),eo(i.uid).then(e=>{e.success&&e.data&&o(e.data.map(e=>({...e,date:(0,ee.GP)(e.entryDate,"MMM d")}))),d(!1)}))},[t,i]);let x=(0,a.useMemo)(()=>{if(!l)return[];let e=new Date;switch(m){case"1m":return l.filter(t=>new Date(t.entryDate)>=(0,et.a)(e,1));case"3m":return l.filter(t=>new Date(t.entryDate)>=(0,et.a)(e,3));case"1y":return l.filter(t=>new Date(t.entryDate)>=(0,et.a)(e,12));default:return l}},[l,m]),{stats:f,domain:p}=(0,a.useMemo)(()=>{if(x.length<2)return{stats:null,domain:[.3,.7]};let e=x[0],t=x[x.length-1],s=e.wthr,r=t.wthr,a=r-s,i=(0,es.B)(t.entryDate,e.entryDate),n=x.map(e=>e.wthr),l=Math.min(...n),o=Math.max(...n);return{stats:{start:s.toFixed(3),startDate:(0,ee.GP)(new Date(e.entryDate),"MMM d, yyyy"),current:r.toFixed(3),currentDate:(0,ee.GP)(new Date(t.entryDate),"MMM d, yyyy"),change:"".concat(a>0?"+":"").concat(a.toFixed(3)),duration:"in ".concat(i),changeType:a>.01?"increase":a<-.01?"decrease":"neutral"},domain:[Math.max(0,Math.floor((l-.05)*10)/10),Math.ceil((o+.05)*10)/10]}},[x]);return(0,r.jsx)(B.lG,{open:t,onOpenChange:s,children:(0,r.jsxs)(B.Cf,{className:"w-[90vw] max-w-2xl",children:[(0,r.jsxs)(B.c7,{children:[(0,r.jsx)(B.L3,{children:"Waist-to-Height Ratio (WtHR) Trend"}),(0,r.jsxs)(B.HM,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(er.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[f&&(0,r.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Start"}),(0,r.jsx)("p",{className:"font-bold text-lg",children:f.start}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:f.startDate})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Current"}),(0,r.jsx)("p",{className:"font-bold text-lg",children:f.current}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:f.currentDate})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Change"}),(0,r.jsxs)("p",{className:(0,N.cn)("font-bold text-lg flex items-center justify-center gap-1","decrease"===f.changeType&&"text-green-400","increase"===f.changeType&&"text-red-400"),children:["decrease"===f.changeType?(0,r.jsx)(ea.A,{className:"h-4 w-4"}):"increase"===f.changeType?(0,r.jsx)(H.A,{className:"h-4 w-4"}):(0,r.jsx)(ei.A,{className:"h-4 w-4"}),f.change]}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:f.duration})]})]}),!h||c?(0,r.jsx)("div",{className:"h-[250px] w-full flex items-center justify-center",children:(0,r.jsx)(R.E,{className:"h-full w-full"})}):x.length>1?(0,r.jsx)("div",{className:"h-[250px] w-full",children:(0,r.jsx)(K.u,{width:"100%",height:"100%",children:(0,r.jsxs)(J.Q,{data:x,margin:{top:5,right:10,left:0,bottom:0},children:[(0,r.jsx)(V.d,{strokeDasharray:"3 3",stroke:"hsl(var(--border) / 0.5)"}),(0,r.jsx)(_.h,{tickLine:!1,axisLine:!1,tickMargin:8,domain:p,tick:{fontSize:"0.75rem"}}),(0,r.jsx)(Z.W,{dataKey:"date",tickLine:!1,axisLine:!1,tickMargin:8,tickFormatter:e=>e.slice(0,3),tick:{fontSize:"0.75rem"}}),(0,r.jsx)(Q.m,{content:(0,r.jsx)(e=>{let{active:t,payload:s,label:a}=e;if(t&&s&&s.length){let e=s[0].payload;return(0,r.jsx)("div",{className:"rounded-lg border bg-background p-2 shadow-sm",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-[0.70rem] uppercase text-muted-foreground",children:"WtHR"}),(0,r.jsx)("span",{className:"font-bold text-muted-foreground",children:e.wthr.toFixed(3)})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"text-[0.70rem] uppercase text-muted-foreground",children:"Date"}),(0,r.jsx)("span",{className:"font-bold",children:a})]})]})})}return null},{})}),(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"fillWthr",x1:"0",y1:"0",x2:"0",y2:"1",children:[(0,r.jsx)("stop",{offset:"5%",stopColor:"hsl(var(--primary))",stopOpacity:.8}),(0,r.jsx)("stop",{offset:"95%",stopColor:"hsl(var(--primary))",stopOpacity:.1})]})}),(0,r.jsx)(Y.G,{dataKey:"wthr",type:"natural",fill:"url(#fillWthr)",stroke:"hsl(var(--primary))",stackId:"a",strokeWidth:2})]})})}):(0,r.jsxs)("div",{className:"h-[250px] w-full flex flex-col items-center justify-center text-center text-muted-foreground",children:[(0,r.jsx)("p",{className:"font-semibold",children:"Not enough data to build a trend."}),(0,r.jsx)("p",{className:"text-sm",children:"Log at least two measurements with waist to see your chart."})]}),(0,r.jsx)(()=>(0,r.jsx)("div",{className:"flex justify-center gap-1 rounded-lg bg-muted p-1",children:["1m","3m","1y","all"].map(e=>(0,r.jsx)(n.$,{onClick:()=>g(e),variant:m===e?"secondary":"ghost",size:"sm",className:"text-xs h-7 flex-1",children:e.toUpperCase()},e))}),{}),x.length>0&&(0,r.jsx)(en.F,{className:"h-24 w-full rounded-md border p-2",children:(0,r.jsx)("div",{className:"space-y-1",children:x.slice().reverse().map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center text-sm p-1 rounded-md hover:bg-muted",children:[(0,r.jsx)("span",{className:"text-muted-foreground",children:(0,ee.GP)(new Date(e.entryDate),"MMM d, yyyy")}),(0,r.jsx)("span",{className:"font-semibold",children:e.wthr.toFixed(3)})]},t))})})]})]})})}var ed=s(13496);let eh=(0,C.createServerReference)("60250e489db16f824ad57137d5adaa6fc10f367d60",C.callServer,void 0,C.findSourceMapURL,"getHabitHighlights"),eu=e=>{let{icon:t,title:s,value:a,unit:i}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center text-center gap-0.5 p-1 rounded-lg bg-white/5",children:[(0,r.jsx)(t,{className:"h-4 w-4 text-primary"}),(0,r.jsx)("span",{className:"text-sm font-bold text-white",children:a}),(0,r.jsx)("span",{className:"text-[10px] text-white/70 leading-none",children:i})]})};function em(){var e,t,s,i,n;let{user:d}=(0,k.A)(),[u,m]=(0,a.useState)(null),[x,f]=(0,a.useState)(!0);return((0,a.useEffect)(()=>{d&&(f(!0),eh(d.uid,7).then(e=>{e.success&&e.data&&m(e.data),f(!1)}))},[d]),x)?(0,r.jsx)("div",{className:"flex justify-center items-center h-24",children:(0,r.jsx)(I.A,{className:"h-8 w-8 animate-spin text-primary"})}):u?(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[(0,r.jsx)(eu,{icon:l.A,title:"Avg. Calories",value:(null==(e=u.averageCalories)?void 0:e.toFixed(0))||"-",unit:"kcal/day"}),(0,r.jsx)(eu,{icon:o.A,title:"Avg. Activity",value:(null==(t=u.averageActivity)?void 0:t.toFixed(0))||"-",unit:"min/day"}),(0,r.jsx)(eu,{icon:c.A,title:"Avg. Sleep",value:(null==(s=u.averageSleep)?void 0:s.toFixed(1))||"-",unit:"hrs/night"}),(0,r.jsx)(eu,{icon:h.A,title:"Avg. Hydration",value:(null==(i=u.averageHydration)?void 0:i.toFixed(0))||"-",unit:"oz/day"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-4 gap-2",children:[(0,r.jsx)(eu,{icon:P.A,title:"Avg. UPF Score",value:(null==(n=u.averageUpfScore)?void 0:n.toFixed(0))||"-",unit:"/ 100"}),(0,r.jsx)(eu,{icon:g.A,title:"Cravings",value:String(u.cravingsLogged),unit:"logged"}),(0,r.jsx)(eu,{icon:W.A,title:"Binges",value:String(u.bingesLogged),unit:"logged"}),(0,r.jsx)(eu,{icon:P.A,title:"Stress Events",value:String(u.stressEventsLogged),unit:"logged"})]})]}):(0,r.jsx)("p",{className:"text-center text-sm text-white/70",children:"Not enough data to show highlights."})}let eg={HeartCrack:W.A,ShieldAlert:P.A,Apple:g.A,Zap:F.A};function ex(e){let{isOpen:t,onClose:s}=e,{toast:i}=(0,G.dj)(),{user:l,userProfile:o}=(0,k.A)(),[c,d]=(0,a.useState)(null),[h,u]=(0,a.useState)(!1),[m,g]=(0,a.useState)(7),[x,f]=(0,a.useState)(null),[p,y]=(0,a.useState)(null),[w,v]=(0,a.useState)(!1),[j,N]=(0,a.useState)(!1),[S,C]=(0,a.useState)(!1),[A,M]=(0,a.useState)(null),[D,T]=(0,a.useState)(!0);(0,a.useEffect)(()=>{C(!0)},[]);let R=async()=>{l&&(u(!0),d(null),y(null),u(!1))};if((0,a.useEffect)(()=>{t&&l&&$().then(e=>{var t;e.success&&(null==(t=e.data)?void 0:t.insightsPopupUrl)?f(e.data.insightsPopupUrl):f("https://placehold.co/1200x400.png")})},[t,l]),(null==o?void 0:o.tier)==="free")return(0,r.jsx)(U.k,{isOpen:t,onClose:s,requiredTier:"basic",featureName:"Personalized Insights",reason:"Unlock deeper understanding of your habits for effortless progress."});let q=A?eg[A.icon]:null;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(B.lG,{open:t,onOpenChange:s,children:(0,r.jsxs)(B.Cf,{className:"w-[90vw] sm:max-w-lg h-[90dvh] p-0 flex flex-col bg-black/25",children:[(0,r.jsxs)("div",{className:"absolute inset-0",children:[x&&(0,r.jsx)(b.default,{src:x,alt:"Insights",fill:!0,className:"object-cover",unoptimized:!0}),(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/60 to-transparent z-0"})]}),(0,r.jsxs)("div",{className:"relative z-10 flex flex-col flex-1 min-h-0 pt-4 pb-4",children:[(0,r.jsxs)(B.c7,{className:"p-4 flex-shrink-0 text-center",children:[(0,r.jsx)(B.L3,{className:"text-lg font-bold tracking-tight text-pop",children:"Insights"}),(0,r.jsx)(B.rr,{className:"text-pop px-4 text-xs italic font-light",children:"Discover patterns in your journey."})]}),(0,r.jsx)("div",{className:"flex-1 min-h-0",children:(0,r.jsx)(en.F,{className:"h-full",children:(0,r.jsx)("div",{className:"p-4 space-y-4",children:(0,r.jsxs)(ed.Accordion,{type:"multiple",defaultValue:["ai-coach","spotlight"],className:"w-full space-y-4",children:[(0,r.jsxs)(ed.AccordionItem,{value:"spotlight",className:"bg-black/40 rounded-lg border-b-0",children:[(0,r.jsx)(ed.AccordionTrigger,{className:"p-4 text-base text-white hover:no-underline",children:"Daily Spotlight"}),(0,r.jsx)(ed.AccordionContent,{className:"px-4 pb-4",children:D?(0,r.jsx)("div",{className:"flex items-center justify-center p-8 rounded-lg bg-white/5",children:(0,r.jsx)(I.A,{className:"h-8 w-8 animate-spin text-primary"})}):A&&q?(0,r.jsxs)("div",{className:"flex items-start gap-3 p-3 rounded-lg bg-white/5",children:[(0,r.jsx)(q,{className:"h-5 w-5 mt-1 text-primary flex-shrink-0"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-semibold text-sm text-white",children:A.title}),(0,r.jsx)("p",{className:"text-sm text-white/80",children:A.message})]})]}):(0,r.jsx)("p",{className:"text-center text-sm text-white/70",children:"No spotlight insight available right now."})})]}),(0,r.jsxs)(ed.AccordionItem,{value:"ai-coach",className:"bg-black/40 rounded-lg border-b-0",children:[(0,r.jsx)(ed.AccordionTrigger,{className:"p-4 text-base text-white hover:no-underline",children:"Hunger-Free and Happy Analysis"}),(0,r.jsxs)(ed.AccordionContent,{className:"px-4 pb-4",children:[(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-2 mb-2",children:[(0,r.jsxs)(O.l6,{onValueChange:e=>g(parseInt(e)),defaultValue:"7",children:[(0,r.jsx)(O.bq,{className:"w-full sm:w-auto bg-background text-foreground",children:(0,r.jsx)(O.yv,{placeholder:"Select time period"})}),(0,r.jsxs)(O.gC,{children:[(0,r.jsx)(O.eb,{value:"3",children:"Last 3 Days"}),(0,r.jsx)(O.eb,{value:"7",children:"Last 7 Days"}),(0,r.jsx)(O.eb,{value:"14",children:"Last 14 Days"}),(0,r.jsx)(O.eb,{value:"30",children:"Last 30 Days"})]})]}),(0,r.jsx)(n.$,{onClick:R,disabled:h,className:"w-full flex-1",children:h?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(I.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating..."]}):"Generate"})]}),p&&(0,r.jsx)("p",{className:"text-center text-xs text-amber-300 p-2",children:p}),h?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center rounded-lg border-2 border-dashed border-white/20 bg-white/5 p-8 text-center min-h-[150px]",children:[(0,r.jsx)(I.A,{className:"h-8 w-8 animate-spin text-primary mb-4"}),(0,r.jsx)("p",{className:"font-semibold text-white",children:"Analyzing your data..."})]}):c?(0,r.jsxs)("div",{className:"rounded-lg bg-black/50 p-4 shadow-inner space-y-3 animate-in fade-in-50 text-white",children:[(0,r.jsxs)("h3",{className:"text-lg font-bold text-primary flex items-center gap-2",children:[(0,r.jsx)(E.A,{className:"h-5 w-5"})," ",c.title]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-sm",children:"Pattern:"}),(0,r.jsx)("p",{className:"text-sm text-white/80",children:c.pattern})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h4",{className:"font-semibold text-sm",children:"Explanation:"}),(0,r.jsx)("p",{className:"text-sm text-white/80",children:c.explanation})]}),(0,r.jsxs)("div",{className:"bg-primary/10 border-l-4 border-primary p-3 rounded-r-lg",children:[(0,r.jsxs)("h4",{className:"font-semibold flex items-center gap-2 text-sm text-primary",children:[(0,r.jsx)(L.A,{className:"h-4 w-4"})," Suggestion:"]}),(0,r.jsx)("p",{className:"text-white/90 text-sm",children:c.suggestion})]})]}):null]})]}),S&&(0,r.jsxs)("div",{className:"bg-black/40 rounded-lg p-4 space-y-2",children:[(0,r.jsxs)(n.$,{variant:"outline",className:"w-full bg-transparent text-white",onClick:()=>v(!0),children:[(0,r.jsx)(H.A,{className:"mr-2 h-4 w-4"}),"Analyze Weight Trend"]}),(0,r.jsxs)(n.$,{variant:"outline",className:"w-full bg-transparent text-white",onClick:()=>N(!0),children:[(0,r.jsx)(z.A,{className:"mr-2 h-4 w-4"}),"Analyze WtHR Trend"]})]}),(0,r.jsxs)(ed.AccordionItem,{value:"habit-highlights",className:"bg-black/40 rounded-lg border-b-0",children:[(0,r.jsx)(ed.AccordionTrigger,{className:"p-4 text-base text-white hover:no-underline",children:"Habit Highlights (Last 7 Days)"}),(0,r.jsx)(ed.AccordionContent,{className:"px-4 pb-4",children:(0,r.jsx)(em,{})})]})]})})})})]})]})}),S&&(0,r.jsx)(el,{isOpen:w,onClose:()=>v(!1)}),S&&(0,r.jsx)(ec,{isOpen:j,onClose:()=>N(!1)})]})}var ef=s(50589),ep=s(89836),ey=s(91195),ew=s(5557),ev=s(98053),eb=s(19708),ej=s(14585);function eN(e){let{isOpen:t,onClose:s,onConfirm:a,content:i,isLocked:l}=e;if(!i)return null;let o=i.icon;return(0,r.jsx)(B.lG,{open:t,onOpenChange:s,children:(0,r.jsxs)(B.Cf,{className:"w-[90vw] max-w-lg p-0 flex flex-col max-h-[85vh]",children:[(0,r.jsxs)(B.c7,{className:"sr-only",children:[(0,r.jsx)(B.L3,{children:i.title}),(0,r.jsx)(B.rr,{children:i.what})]}),(0,r.jsx)("div",{className:"flex-shrink-0 p-6 space-y-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"mx-auto bg-primary/10 rounded-full h-16 w-16 flex items-center justify-center mb-2",children:(0,r.jsx)(o,{className:"h-8 w-8 text-primary"})}),l&&(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsxs)(q.E,{variant:"secondary",className:"bg-amber-500/20 text-amber-300 border-amber-500/30 w-fit",children:[(0,r.jsx)(p.A,{className:"h-3 w-3 mr-1"}),i.requiredTier.charAt(0).toUpperCase()+i.requiredTier.slice(1)," Plan Required"]})})]})}),(0,r.jsx)("div",{className:"flex-1 min-h-0 px-6",children:(0,r.jsx)(en.F,{className:"h-full",children:(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-primary",children:"What is it?"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:i.what})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-primary",children:"How do I use it?"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:i.how})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("h3",{className:"font-semibold text-primary",children:"Why does it work?"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:i.why})]})]})})}),(0,r.jsxs)("div",{className:"p-6 pt-2 mt-auto flex flex-row gap-2 flex-shrink-0",children:[(0,r.jsx)(n.$,{onClick:s,variant:"outline",className:"flex-1",children:"Close"}),(0,r.jsx)(n.$,{onClick:a,className:"flex-1",children:l?"Upgrade to ".concat(i.requiredTier.charAt(0).toUpperCase()+i.requiredTier.slice(1)):"Get Started"})]})]})})}var ek=s(27500),eS=s(28127);let eC={nutrition:{id:"nutrition",title:"Nutrition",icon:l.A,what:"Log your meals to understand your eating patterns and nutritional intake, focusing on whole foods over ultra-processed ones.",how:"Use the powerful food search to find items, view their UPF score, and add them to your daily log. The app automatically calculates your macro and micronutrient totals for the day.",why:"Consistent logging reveals the direct link between what you eat and how you feel, empowering you to choose foods that increase energy, stabilize mood, and reduce cravings.",requiredTier:"free"},activity:{id:"activity",title:"Activity",icon:o.A,what:"Track any form of joyful movement, from a walk in the park to a structured workout.",how:"Select an activity type, set the duration and intensity, and note how your hunger levels change before and after. This helps you understand your body's true energy needs.",why:"Movement is a key regulator of hunger hormones and stress. Tracking activity helps you find the right balance to boost metabolism and mood without triggering compensatory eating.",requiredTier:"free"},sleep:{id:"sleep",title:"Sleep",icon:c.A,what:"Log your nightly sleep duration and quality to see its profound impact on your next-day choices.",how:"Enter your wake-up time, sleep duration, and rate the quality of your sleep. Also note your waking hunger and stress levels to draw clear connections.",why:"Sleep is the foundation. It regulates hunger hormones like ghrelin and leptin. Improving sleep is often the single most effective step to reducing cravings and managing weight.",requiredTier:"free"},hydration:{id:"hydration",title:"Hydration",icon:h.A,what:"Track your daily water and fluid intake to ensure your body is properly hydrated.",how:"Quickly add your water intake throughout the day using the preset buttons or by entering a custom amount. Set a daily goal and reminders to stay on track.",why:"Thirst is often mistaken for hunger. Proper hydration is critical for managing false hunger signals, boosting metabolism, and improving energy levels.",requiredTier:"free"},stress:{id:"stress",title:"Stress & Cravings",icon:d.A,what:"Log moments of high stress or cravings to identify triggers and develop coping strategies.",how:"When you feel stressed or have a craving, log the event, its intensity, and any suspected triggers. If you used a relief strategy, log that too to see what works.",why:"Stress is a primary driver of cravings and emotional eating. By logging these events, you turn them from setbacks into data points, helping the AI identify patterns you can break.",requiredTier:"basic"},protocol:{id:"protocol",title:"75/20/20 Protocol",icon:u.A,what:"A mindful eating exercise to reconnect with your body's natural fullness signals.",how:"Eat 75% of your meal, drink 20oz of water, and then wait 20 minutes. Use the built-in timer and log your pre- and post-meal hunger levels to train your body to recognize satiety.",why:"This powerful technique breaks the habit of overeating by giving your brain and stomach time to communicate. It teaches you to stop eating when you are satisfied, not stuffed.",requiredTier:"basic"},planner:{id:"planner",title:"Indulgence Planner",icon:m.A,what:"Plan for indulgences in a structured way to enjoy them guilt-free and without derailing your progress.",how:"Schedule an upcoming indulgence, noting the occasion. Create a plan for your meals and hydration *before* the event, and a recovery meal for *after*.",why:"Planning removes the guilt and spontaneity that often leads to a binge. It puts you in control, turning a potential setback into a planned, enjoyable part of your life.",requiredTier:"basic"},cravings:{id:"cravings",title:"Stress & Cravings",icon:g.A,what:"Log moments of high stress or cravings to identify triggers and develop coping strategies.",how:"When you feel stressed or have a craving, log the event, its intensity, and any suspected triggers. If you used a relief strategy, log that too to see what works.",why:"Stress is a primary driver of cravings and emotional eating. By logging these events, you turn them from setbacks into data points, helping the AI identify patterns you can break.",requiredTier:"basic"},insights:{id:"insights",title:"AI Insights",icon:x.A,what:"Your personal AI coach that analyzes your data to find hidden patterns and provide actionable advice.",how:'Select a time period (e.g., last 7 days) and click "Generate". The AI will review your logs across all pillars to find the most important connection and give you a specific suggestion.',why:'The AI can see connections you might miss, like how a poor night\'s sleep leads to more sugar cravings two days later. These insights provide the "aha!" moments that accelerate your progress.',requiredTier:"basic"},measurements:{id:"measurements",title:"Measurements",icon:f.A,what:"Track your weight and waist circumference to see long-term trends beyond daily fluctuations.",how:"Enter your weight and waist measurements periodically. The app will automatically calculate your Waist-to-Height Ratio (WtHR), a key health indicator.",why:"Focusing on the trend, not the daily number, provides a truer picture of your progress. Tracking WtHR is a powerful motivator and a better indicator of health than weight alone.",requiredTier:"free"},challenges:{id:"challenges",title:"Community Challenges",icon:y.A,what:"Join group challenges with fellow users to build consistency and stay motivated.",how:"Browse available challenges, join one that interests you, and complete the daily tasks. Track your progress and streaks alongside the community in a shared chat.",why:"Accountability and community are powerful motivators. Challenges provide a structured way to build new habits and learn from others on the same journey.",requiredTier:"premium"},chats:{id:"chats",title:"Community Chats",icon:ek.A,what:"Connect with coaches and other users in group chats for support and motivation.",how:"Join open chats based on topics or challenges. Participate in discussions, ask questions, and share your wins and struggles with the community.",why:"You are not alone. Sharing the journey with others provides support, accountability, and new perspectives, making it easier to stay on track and feel connected.",requiredTier:"premium"},calendar:{id:"calendar",title:"Calendar",icon:eS.A,what:"View all your logged data in a comprehensive calendar view.",how:"See your daily, weekly, and monthly logs at a glance. Click on any day to see a detailed timeline of your activities, meals, and other entries.",why:'The calendar provides a "big picture" view of your habits, making it easy to spot trends, review past successes, and plan for the future.',requiredTier:"free"}},eA=JSON.parse('["Small steps compound for unstoppable wellness.","Hydration quiets false hunger signals effortlessly.","Sleep restores hormone balance for calm mornings.","Stress relief rewires responses for natural calm.","Joyful movement builds resilience without force.","Whole foods satisfy with lasting fullness.","Pause to listen to your body\'s wisdom.","Celebrate consistency in every small sip.","Rest renews your strength for joyful days.","Breathe to transform tension into tranquility.","Move with delight for effortless energy.","Protein plates curb cravings intuitively.","False noise fades with pillar alignment.","Hydration clears the fog of false urges.","Quality sleep unlocks appetite harmony.","Calm conquers emotional eating gently.","Activity sparks joy in every step.","Nutrient-dense meals fuel without fanfare.","Mindful moments make mastery effortless.","Water whispers balance to your body.","Sleep\'s secret weapon silences cravings.","Relief releases the grip of stress.","Movement ignites your inner vitality.","Whole foods whisper satiety softly.","Growth blooms from gentle adjustments.","Sip to stabilize your hunger signals.","Rest recharges for craving-free days.","Breathe calm into your cravings.","Dance through days with joyful energy.","Protein powers intuitive portion control.","Patterns reveal paths to peace.","Hydrate for hormone harmony now.","Sleep strengthens your signal clarity.","Relief rewires for resilient responses.","Activity awakens natural appetite balance.","Foods fuel fullness without force.","Celebrate every cue you conquer.","Water washes away false wants.","Rest resets your reward system.","Calm curbs compulsive cues.","Move to mute the noise.","Nourish naturally for noise-free nights.","Insights ignite effortless change.","Hydration holds hunger at bay.","Sleep soothes the soul\'s signals.","Relief releases relentless thoughts.","Exercise energizes without effort.","Whole plates whisper wellness.","Growth greets gentle habits.","Sip serenity into your day.","Rest renews craving control.","Breathe balance into being.","Move mindfully for mastery.","Fuel fully with fresh foods.","Celebrate cues as teachers.","Water weaves wellness within.","Sleep silences subtle urges.","Calm conquers craving chaos.","Activity aligns appetite naturally.","Nourish for natural harmony.","Patterns pave peaceful paths.","Hydrate to harmonize hunger.","Rest restores resilient responses.","Relief reclaims calm control.","Movement mends mental noise.","Foods foster fullness freely.","Insights inspire intuitive living.","Water whispers wise wellness.","Sleep strengthens signal savvy.","Breathe beyond binge barriers.","Dance defeats daily distractions.","Protein promises peaceful portions.","Growth graces gentle guidance.","Sip to silence false signals.","Rest reboots reward rhythms.","Calm clears compulsive clouds.","Move to master mindfulness.","Nourish naturally, noise-free.","Patterns point to progress.","Hydrate for happy harmony.","Sleep soothes stress surges.","Relief renews resilient resolve.","Activity awakens authentic appetite.","Whole foods weave wellness wonders.","Celebrate curiosity in cues.","Water washes worry away.","Rest recharges radiant resilience.","Breathe boundless balance.","Movement mends mindful moments.","Fuel for freedom from noise.","Insights illuminate intuitive paths.","Hydration holds harmony high.","Sleep silences sneaky stress.","Relief releases radiant renewal.","Exercise elevates effortless energy.","Nourish for noise-free nourishment.","Patterns propel peaceful progress.","Water welcomes wise whispers.","Rest restores rhythmic renewal.","Calm cultivates craving control.","Move mindfully, masterfully.","Whole foods whisper wonder.","Growth greets guiding glimpses.","Sip serenity, savor success.","Sleep strengthens serene signals.","Breathe beyond burdensome binges.","Dance daily, defeat distractions.","Protein powers peaceful paths.","Insights inspire infinite intuition.","Hydrate happily, harmonize hunger.","Rest reclaims radiant rest.","Relief renews resilient rhythms.","Activity aligns authentic awareness.","Nourish naturally, nurture noise-free.","Patterns pave profound peace.","Water weaves wellness waves.","Sleep soothes soulful signals.","Calm conquers chaotic cues.","Movement mends masterful mindfulness.","Fuel fully, free from force.","Celebrate cues, cultivate calm.","Hydration holds healing harmony.","Rest restores resilient radiance.","Breathe boundless, balanced bliss.","Exercise elevates eternal energy.","Whole foods whisper wise wellness.","Growth graces gentle growth.","Sip to soothe subtle surges.","Sleep silences silent stress.","Relief rekindles radiant resolve.","Activity awakens aware alignment.","Nourish for natural nourishment.","Patterns point to peaceful paths.","Water welcomes wellness whispers.","Rest recharges rhythmic rest.","Calm clears craving clouds.","Move to mindful mastery.","Fuel for fearless freedom.","Insights illuminate infinite insights.","Hydrate for harmonious health.","Sleep strengthens signal strength.","Breathe beyond binge boundaries.","Dance defeats distracting desires.","Protein promises profound peace.","Growth greets guiding grace.","Sip serenity into signals.","Rest renews reward renewal.","Calm conquers compulsive chaos.","Movement mends mental mastery.","Nourish naturally for noise-free.","Patterns propel profound patterns.","Water weaves wise waves.","Sleep soothes serene sleep.","Relief releases resilient relief.","Exercise elevates effortless exercise.","Whole foods whisper whole wellness.","Celebrate curiosity, cultivate cues.","Hydration holds healing health.","Rest restores resilient rest.","Breathe boundless balanced breath.","Move mindfully masterful move.","Fuel fully free fuel.","Insights inspire intuitive insights.","Hydrate happily harmonious hydrate.","Sleep silences sneaky sleep.","Calm clears chaotic calm.","Activity aligns authentic activity.","Nourish naturally nurturing nourish.","Patterns pave peaceful patterns.","Water welcomes wise water.","Rest recharges rhythmic rest.","Relief renews resilient relief.","Movement mends masterful movement.","Whole foods weave whole wellness.","Growth graces gentle growth.","Sip serenity savor sip.","Sleep strengthens serene sleep.","Breathe beyond burdensome breath.","Dance defeats daily dance.","Protein powers peaceful protein.","Insights illuminate infinite illuminate.","Hydration holds harmony hydration.","Rest restores radiant rest.","Calm conquers craving calm.","Activity awakens aware activity.","Nourish for noise-free nourish.","Patterns point to progress patterns.","Water whispers wise water.","Sleep soothes soulful sleep.","Relief releases radiant relief.","Exercise elevates eternal exercise.","Whole foods whisper wonder whole.","Celebrate cues cultivate celebrate.","Hydration holds healing hydration.","Rest renews reward rest.","Breathe boundless balance breathe.","Move mindfully master move.","Fuel fully free fuel.","Insights inspire intuitive inspire.","Hydrate happily harmony hydrate."]'),eM=[{id:"nutrition",label:"Nutrition",icon:l.A,color:"text-foreground",bgColor:"bg-amber-400",borderColor:"border-amber-600",requiredTier:"free"},{id:"activity",label:"Activity",icon:o.A,color:"text-foreground",bgColor:"bg-orange-400",borderColor:"border-orange-600",requiredTier:"free"},{id:"sleep",label:"Sleep",icon:c.A,color:"text-foreground",bgColor:"bg-indigo-400",borderColor:"border-indigo-600",requiredTier:"free"},{id:"stress",label:"Stress Relief",icon:d.A,color:"text-foreground",bgColor:"bg-green-400",borderColor:"border-green-600",requiredTier:"basic"},{id:"hydration",label:"Hydration",icon:h.A,color:"text-foreground",bgColor:"bg-blue-400",borderColor:"border-blue-600",requiredTier:"free"},{id:"protocol",label:"75/20/20 Protocol",icon:u.A,color:"text-foreground",bgColor:"bg-teal-400",borderColor:"border-teal-600",requiredTier:"basic"},{id:"planner",label:"Indulgence Planner",icon:m.A,color:"text-foreground",bgColor:"bg-lime-400",borderColor:"border-lime-600",requiredTier:"basic"},{id:"cravings",label:"Cravings/Binges",icon:g.A,color:"text-foreground",bgColor:"bg-red-400",borderColor:"border-red-600",requiredTier:"basic"},{id:"insights",label:"Insights",icon:x.A,color:"text-foreground",bgColor:"bg-yellow-400",borderColor:"border-yellow-600",requiredTier:"basic"},{id:"measurements",label:"Measurements",icon:f.A,color:"text-foreground",bgColor:"bg-gray-400",borderColor:"border-gray-600",requiredTier:"free"}],eD=eM.slice(0,5),eT=eM.slice(5,10),eR=e=>e?e instanceof Date?e:"string"==typeof e||"number"==typeof e?new Date(e):e.toDate&&"function"==typeof e.toDate?e.toDate():null:null;function eq(){let{onOpenChallenges:e}=(0,ep.vg)(),{user:t,userProfile:s}=(0,k.A)(),{toast:l}=(0,G.dj)(),[o,c]=(0,a.useState)(!1),[d,h]=(0,a.useState)(!1),[u,g]=(0,a.useState)(null),[x,f]=(0,a.useState)(null),[C,W]=(0,a.useState)(!0),[P,F]=(0,a.useState)([]),[E,L]=(0,a.useState)(!0),[H,z]=(0,a.useState)(!1),[O,B]=(0,a.useState)(void 0),[$,K]=(0,a.useState)(void 0),[J,V]=(0,a.useState)(!1),[_,Z]=(0,a.useState)(!1),[Q,Y]=(0,a.useState)(null),[X,et]=(0,a.useState)(null),[es,er]=(0,a.useState)(!1),[ea,ei]=(0,a.useState)(!1),[en,el]=(0,a.useState)(!1),[eo,ec]=(0,a.useState)(!1),{onOpenCalendar:ed}=(0,ep.vg)();(0,a.useEffect)(()=>{ei(!0)},[]);let eh=(0,a.useCallback)(e=>"true"===localStorage.getItem("hasSeen_".concat(e)),[]),eu=(0,a.useCallback)(e=>{localStorage.setItem("hasSeen_".concat(e),"true")},[]),em=e=>{"insights"===e.id?h(!0):(g(e),c(!0))},eg=(0,a.useCallback)(async()=>{t&&(W(!0),L(!0),D().then(e=>{e.success&&e.data?f(e.data):e.error&&"not-found"!==e.error&&l({variant:"destructive",title:"Error",description:"Could not load challenge: ".concat(e.error)}),W(!1)}),A(t.uid).then(e=>{e.success&&e.data&&F(e.data),L(!1)}))},[t,l]);(0,a.useEffect)(()=>{t&&eg()},[t,eg]),(0,a.useEffect)(()=>{if(null==t?void 0:t.uid){let e=(0,eb.H9)(ej.db,"clients",t.uid),s=(0,eb.aQ)(e,e=>{if(e.exists()){let t=e.data();t.bingeFreeSince&&Y(t.bingeFreeSince)}});return()=>s()}},[null==t?void 0:t.uid]),(0,a.useEffect)(()=>{ed&&(ed._open=()=>{B(new Date),K(void 0),z(!0)})},[ed]);let ek=async()=>{if(t){V(!0);try{let e=await M(t.uid);if(e.success)l({title:"Streak Reset",description:"Your binge-free streak has been reset to 0 days."});else throw Error(e.error||"Failed to reset streak.")}catch(e){l({variant:"destructive",title:"Error",description:e.message})}finally{V(!1),Z(!1)}}},eS=(0,a.useMemo)(()=>eR(Q||(null==s?void 0:s.bingeFreeSince)),[Q,s]),eq=(0,a.useMemo)(()=>eS?(0,ey.m)(new Date,eS):0,[eS]),eW=eA[(()=>{let e=new Date,t=new Date(e.getFullYear(),0,0);return Math.floor((e.getTime()-t.getTime())/864e5)})()%eA.length],eP=async e=>{if(!t)return;ec(!0);let s=await T(e,t.uid);s.success?(l({title:"Challenge Joined!",description:"You have successfully joined the challenge."}),eg()):l({variant:"destructive",title:"Error Joining Challenge",description:s.error}),ec(!1)},eF=e=>{let t=e.icon,a=(s?S.qc.indexOf(s.tier):0)<S.qc.indexOf(e.requiredTier);return(0,r.jsxs)("button",{onClick:()=>(e=>{if(!s||!ea)return;let t=eC[e.id],r=eh(e.id);t&&!r?(et(t),er(!0)):em(e)})(e),className:(0,N.cn)("group relative flex flex-col items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-full text-center transition-all shadow-sm btn-3d",e.bgColor,e.color,e.borderColor),children:[a&&(0,r.jsx)("div",{className:"absolute inset-0 bg-black/50 rounded-full"}),(0,r.jsx)(t,{className:(0,N.cn)("h-8 w-8 sm:h-10 sm:h-10 transition-transform group-hover:scale-110",a&&"opacity-50")}),a&&(0,r.jsx)(p.A,{className:"h-4 w-4 absolute top-2 right-2 sm:top-3 sm:right-3 text-white/70"})]},e.id)},eI=!!s&&!!X&&S.qc.indexOf(s.tier)<S.qc.indexOf(X.requiredTier);return(0,r.jsxs)("div",{className:"space-y-6 pb-10",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h2",{className:"text-2xl font-bold tracking-tight",children:["Welcome, ",null==s?void 0:s.fullName.split(" ")[0],"!"]}),(0,r.jsxs)("p",{className:"text-lg text-muted-foreground",children:["“",eW,"” ~Alan Roberts"]})]}),(0,r.jsx)("div",{className:"flex justify-around",children:eD.map(eF)}),(0,r.jsx)("div",{className:"flex justify-around",children:eT.map(eF)}),(null==s?void 0:s.tier)===S.Kx.Free&&(0,r.jsx)("div",{className:"my-2",children:(0,r.jsx)(ef.V,{slotId:"13167805261"})}),(()=>{if(C)return(0,r.jsx)(R.E,{className:"h-40 w-full rounded-xl"});if(!x)return(0,r.jsx)(i.Zp,{className:"bg-primary/10 border-primary/20 hover:border-primary/40 transition-all",children:(0,r.jsxs)(i.Wu,{className:"p-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"relative w-24 h-24 rounded-lg overflow-hidden flex-shrink-0 bg-primary/20 flex items-center justify-center",children:(0,r.jsx)(y.A,{className:"w-12 h-12 text-primary/50"})}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold text-lg text-card-foreground leading-tight",children:"No Active Challenges"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:"Check back soon for the next community challenge, or view past challenges to see what you've missed!"})]}),(0,r.jsxs)(n.$,{size:"sm",className:"w-full sm:w-auto",onClick:e,children:["View All Challenges ",(0,r.jsx)(w.A,{className:"ml-2 h-4 w-4"})]})]})]})});let a=x.participants.includes((null==t?void 0:t.uid)||""),l=new Date,o=eR(x.dates.from);if(!o)return null;let c=o>l,d=!a&&S.qc.indexOf((null==s?void 0:s.tier)||S.Kx.Free)>=S.qc.indexOf(S.Kx.Premium),h=!a&&S.qc.indexOf((null==s?void 0:s.tier)||S.Kx.Free)<S.qc.indexOf(S.Kx.Premium),u="";return u=a?c?"Registered":"Active Now":c?"Starts Soon":"New Challenge!",(0,r.jsx)(i.Zp,{className:"bg-primary/10 border-primary/20 hover:border-primary/40 transition-all",children:(0,r.jsxs)(i.Wu,{className:"p-4 flex items-center gap-4",children:[(0,r.jsx)("div",{className:"relative w-24 h-24 rounded-lg overflow-hidden flex-shrink-0",children:(0,r.jsx)(b.default,{src:x.thumbnailUrl||"https://placehold.co/400x400.png",alt:x.name,fill:!0,className:"object-cover",unoptimized:!0})}),(0,r.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)(q.E,{variant:"secondary",className:"mb-1",children:u}),(0,r.jsx)("h3",{className:"font-bold text-lg text-card-foreground leading-tight",children:x.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:x.description})]}),a?(0,r.jsxs)(n.$,{size:"sm",className:"w-full sm:w-auto",onClick:e,children:["View Challenge ",(0,r.jsx)(w.A,{className:"ml-2 h-4 w-4"})]}):d?(0,r.jsxs)(n.$,{size:"sm",className:"w-full sm:w-auto",onClick:()=>eP(x.id),disabled:eo,children:[eo&&(0,r.jsx)(I.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Join Challenge ",(0,r.jsx)(w.A,{className:"ml-2 h-4 w-4"})]}):h?(0,r.jsxs)(n.$,{size:"sm",className:"w-full sm:w-auto",onClick:()=>el(!0),children:["Upgrade to Join ",(0,r.jsx)(p.A,{className:"ml-2 h-4 w-4"})]}):(0,r.jsxs)(n.$,{size:"sm",className:"w-full sm:w-auto",onClick:e,children:["View Details ",(0,r.jsx)(w.A,{className:"ml-2 h-4 w-4"})]})]})]})})})(),E?(0,r.jsx)(R.E,{className:"h-24 w-full"}):P.length>0&&(0,r.jsx)(i.Zp,{className:"p-3",children:(0,r.jsxs)(i.Wu,{className:"p-0",children:[(0,r.jsxs)("h3",{className:"text-sm font-semibold flex items-center gap-2 mb-2",children:[(0,r.jsx)(m.A,{className:"h-5 w-5 text-lime-400"}),"Upcoming Planned Indulgences"]}),(0,r.jsx)("div",{className:"space-y-1",children:P.map(e=>{let t=eR(e.indulgenceDate);return t?(0,r.jsxs)("div",{className:"flex items-center justify-between p-1.5 rounded-md bg-muted/50 text-xs w-full",children:[(0,r.jsx)("p",{className:"font-medium",children:e.plannedIndulgence}),(0,r.jsx)("p",{className:"text-muted-foreground",children:(0,ee.GP)(t,"MMM d")})]},e.id):null})})]})}),s&&eS&&(0,r.jsx)(i.Zp,{className:"p-3",children:(0,r.jsxs)(i.Wu,{className:"p-0 flex items-center justify-between gap-4",children:[(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)("p",{className:"text-sm font-semibold text-green-400",children:"Binge-Free Streak"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:"Last binge: ".concat((0,ee.GP)(eS,"MMM d, yyyy"))})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsxs)("div",{className:"flex items-baseline gap-1 text-right",children:[(0,r.jsx)("p",{className:"text-4xl font-bold text-white",children:eq}),(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"Days"})]}),(0,r.jsx)(n.$,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground",onClick:()=>Z(!0),children:(0,r.jsx)(v.A,{className:"h-4 w-4"})})]})]})}),u&&(0,r.jsx)(j.X,{open:o,onOpenChange:e=>{c(!1),g(null),e&&eg()},pillar:u,onSwitchPillar:e=>{let t=eM.find(t=>t.id===e);t&&(g(t),c(!0))}}),(0,r.jsx)(ex,{isOpen:d,onClose:()=>h(!1)}),(0,r.jsx)(U.k,{isOpen:en,onClose:()=>el(!1),requiredTier:S.Kx.Premium,featureName:"Community Challenges",reason:"Joining community challenges is a premium feature. Upgrade your account to participate and take your journey to the next level!"}),ea&&X&&(0,r.jsx)(eN,{isOpen:es,onClose:()=>{X&&eu(X.id),er(!1)},onConfirm:()=>{if(!X)return;eu(X.id),er(!1);let e=eM.find(e=>e.id===X.id);e&&setTimeout(()=>{em(e)},150)},content:X,isLocked:eI}),s&&(0,r.jsx)(ew.D,{isOpen:H,onClose:()=>z(!1),client:s,initialDate:O,highlightedEntryId:$}),(0,r.jsx)(ev.Lt,{open:_,onOpenChange:Z,children:(0,r.jsxs)(ev.EO,{children:[(0,r.jsxs)(ev.wd,{children:[(0,r.jsx)(ev.r7,{children:"Are you sure?"}),(0,r.jsx)(ev.$v,{children:"This will reset your binge-free streak to 0 days. This action cannot be undone."})]}),(0,r.jsxs)(ev.ck,{children:[(0,r.jsx)(ev.Zr,{children:"Cancel"}),(0,r.jsxs)(ev.Rx,{onClick:ek,disabled:J,children:[J&&(0,r.jsx)(I.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Reset Streak"]})]})]})})]})}function eW(){return(0,r.jsx)(eq,{})}},20243:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var r=s(95155),a=s(64269);function i(e){let{className:t,...s}=e;return(0,r.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",t),...s})}},50589:(e,t,s)=>{"use strict";s.d(t,{V:()=>i});var r=s(95155),a=s(12115);function i(e){let{slotId:t}=e,s=(0,a.useRef)(null);return(0,a.useEffect)(()=>{if(s.current&&"filled"!==s.current.getAttribute("data-ad-status"))try{(window.adsbygoogle=window.adsbygoogle||[]).push({})}catch(e){console.error(e)}},[t]),(0,r.jsx)("div",{className:"text-center my-4 h-16 flex items-center justify-center",children:(0,r.jsx)("ins",{ref:s,className:"adsbygoogle",style:{display:"block"},"data-ad-client":"pub-6658282343757105","data-ad-slot":t,"data-ad-format":"auto","data-full-width-responsive":"true"})})}},72812:(e,t,s)=>{Promise.resolve().then(s.bind(s,6150))}},e=>{e.O(0,[2992,7138,781,5612,5352,9118,8038,4972,6238,537,7075,6743,6201,8665,7071,7473,7961,8441,1255,7358],()=>e(e.s=72812)),_N_E=e.O()}]);